var C=Object.defineProperty;var A=(a,e,s)=>e in a?C(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s;var g=(a,e,s)=>A(a,typeof e!="symbol"?e+"":e,s);import{r as u,g as x,_ as w,c as d,o as v,a as l,w as _,b as E,v as k,F as P,d as V,t as N,e as m,u as O,s as f,p as $,f as D}from"./_plugin-vue_export-helper-C0IU9tpe.js";import{s as L,L as T,S as B,C as J}from"./Loading-IB13jVZQ.js";class I{constructor(){g(this,"supplier",u({}));g(this,"allSuppliers",u({}));g(this,"suppliersSearch",u({}));this.suppliersStorage="mercado-solidario-suppliers",this.loadAll(),this.load()}async loadAll(){const e=sessionStorage.getItem(this.suppliersStorage);if(e!=null)this.allSuppliers.value=JSON.parse(e);else{const s=await x("/supplier");s.status==200&&(this.allSuppliers.value=s.data,this.saveAll())}}saveAll(){sessionStorage.setItem(this.suppliersStorage,JSON.stringify(this.allSuppliers.value))}load(){const e=localStorage.getItem(this.suppliersStorage);e!=null&&(this.supplier.value=JSON.parse(e))}save(){localStorage.setItem(this.suppliersStorage,JSON.stringify(this.supplier.value))}createSupplier(e){this.allSuppliers.value[e.id]=e,this.saveAll()}deleteSupplier(e){delete this.allSuppliers.value[e],this.saveAll()}addSupplier(e){const s=this.allSuppliers.value[e];if(!s)return null;this.supplier.value=s,this.save()}delSupplier(e){if(!this.allSuppliers.value[e])return null;this.supplier.value={},this.save()}getSupplier(){return Object.keys(this.supplier.value).length===0?null:this.supplier.value}searchName(e){this.clearNamesSearch();const s=new RegExp(e,"i");Object.keys(this.allSuppliers.value).forEach(r=>{const p=this.allSuppliers.value[r];p.name.match(s)&&(this.suppliersSearch.value[r]=p)})}clearNamesSearch(){this.suppliersSearch.value={}}}const R={class:"miniSubPage blackPage borderRound"},z={class:"searchBar"},M={class:"searchInput"},U={key:0},q=["onClick"],F={__name:"SearchSupplier",props:{supplierObj:I},setup(a){const e=a,s=u("");function r(o){o.target.value.length>2?e.supplierObj.searchName(o.target.value):e.supplierObj.clearNamesSearch()}function p(o){e.supplierObj.addSupplier(o),e.supplierObj.clearNamesSearch(),s.value=""}return(o,n)=>(v(),d("div",R,[l("div",z,[l("div",M,[_(l("input",{"onUpdate:modelValue":n[0]||(n[0]=i=>s.value=i),onInput:r},null,544),[[k,s.value]]),s.value?(v(),d("ul",U,[(v(!0),d(P,null,V(a.supplierObj.suppliersSearch.value,(i,S)=>(v(),d("li",null,[l("span",{onClick:c=>p(S)},N(i.name),9,q)]))),256))])):E("",!0)]),n[1]||(n[1]=l("p",null," Selecionar fornecedor ",-1))]),l("a",null,N(a.supplierObj.supplier.value.name),1)]))}},G=w(F,[["__scopeId","data-v-a2d7ff1d"]]),H={key:0,class:"blackPage borderRound divSubpage"},K={key:1,class:"divPage"},Q={class:"wrapper"},W={class:"dados miniSubPage blackPage borderRound"},X={__name:"App",setup(a){const e=new L("checkin"),s=new I,r=new Date,p=r.getTimezoneOffset()*6e4,n=new Date(r-p).toISOString().slice(0,16),i=u(n),S=u(""),c=u(!1);async function y(){c.value=!0;const b=e.getCart();if(b==null)return f("Erro","Carrinho vazio"),c.value=!1,null;const t=s.getSupplier();if(t==null)return f("Erro","Sem fornecedor"),c.value=!1,null;const h={cart:b,supplier_id:t.id,created_at:i.value,obs:S.value},j=await $("/checkin",h);j.status==200?(f("Sucesso","Estoque abastecido"),e.clearCart()):f("Erro",j.message),c.value=!1}return(b,t)=>c.value?(v(),d("div",H,[m(T)])):(v(),d("div",K,[m(B,{class:"stock",stockObj:O(e)},null,8,["stockObj"]),l("div",Q,[m(G,{class:"search",supplierObj:O(s)},null,8,["supplierObj"]),l("div",W,[t[2]||(t[2]=l("p",null,"Data de criação",-1)),_(l("input",{"onUpdate:modelValue":t[0]||(t[0]=h=>i.value=h),type:"datetime-local"},null,512),[[k,i.value]]),t[3]||(t[3]=l("p",null,"Observações",-1)),_(l("textarea",{"onUpdate:modelValue":t[1]||(t[1]=h=>S.value=h)},null,512),[[k,S.value]])]),m(J,{class:"cart",stockObj:O(e),onSend:y},null,8,["stockObj"])])]))}},Y=w(X,[["__scopeId","data-v-bcb468e5"]]);D(Y).mount("#app");
